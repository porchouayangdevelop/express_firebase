{"version":3,"file":"ts-object-path.umd.js","sources":["../src/ts-object-path.ts"],"sourcesContent":["import { ObjPathProxy } from './obj-path-proxy';\nexport * from './obj-path-proxy';\n\nexport type ObjProxyArg<TRoot, T> = ObjPathProxy<TRoot, T> | ((p: ObjPathProxy<TRoot, TRoot>)=> ObjPathProxy<TRoot, T>);\n\nconst pathSymbol = Symbol('Object path');\n\nexport function createProxy<T>(path: PropertyKey[] = []): ObjPathProxy<T, T> {\n  const proxy = new Proxy({[pathSymbol]: path}, {\n    get (target, key) {\n      if (key === pathSymbol) {\n        return target[pathSymbol];\n      }\n      if (typeof key === 'string') {\n        const intKey = parseInt(key, 10);\n        if (key === intKey.toString()) {\n          key = intKey;\n        }\n      }\n      return createProxy([...(path || []), key]);\n    }\n  });\n  return proxy as any as ObjPathProxy<T, T>;\n}\n\nexport function getPath<TRoot, T>(proxy: ObjProxyArg<TRoot, T>): PropertyKey[] {\n  if (typeof proxy === 'function') {\n    proxy = proxy(createProxy<TRoot>())\n  }\n  return (proxy as any)[pathSymbol];\n}\n\nexport function isProxy<TRoot, T>(value: any): value is ObjPathProxy<TRoot, T> {\n  return value && typeof value === 'object' && !!getPath<TRoot, T>(value as ObjPathProxy<TRoot, T>);\n}\n\nexport function get<TRoot, T>(object: TRoot, proxy: ObjProxyArg<TRoot, T>, defaultValue: T|null|undefined = undefined) {\n  return getPath(proxy).reduce((o, key) => o && o[key] || defaultValue, object as any) as T;\n}\n\nexport function set<TRoot, T>(object: TRoot, proxy: ObjProxyArg<TRoot, T>, value: T): void {\n  getPath(proxy).reduce((o: any, key, index, keys) => {\n    if (index < keys.length - 1) {\n      o[key] = o[key] || (typeof keys[index + 1] === 'number' ? [] : {});\n      return o[key];\n    }\n    o[key] = value;\n  }, object);\n}\n\n"],"names":[],"mappings":";;;;;;AAKA,IAAM,UAAU,GAAG,MAAM,CAAC,aAAa,CAAC,CAAC;AAEzC,qBAA+B,IAAwB;IAAxB,qBAAA,EAAA,SAAwB;IACrD,IAAM,KAAK,GAAG,IAAI,KAAK,WAAE,GAAC,UAAU,IAAG,IAAI,OAAG;QAC5C,GAAG,YAAE,MAAM,EAAE,GAAG;YACd,IAAI,GAAG,KAAK,UAAU,EAAE;gBACtB,OAAO,MAAM,CAAC,UAAU,CAAC,CAAC;aAC3B;YACD,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;gBAC3B,IAAM,MAAM,GAAG,QAAQ,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;gBACjC,IAAI,GAAG,KAAK,MAAM,CAAC,QAAQ,EAAE,EAAE;oBAC7B,GAAG,GAAG,MAAM,CAAC;iBACd;aACF;YACD,OAAO,WAAW,CAAK,CAAC,IAAI,IAAI,EAAE,UAAG,GAAG,GAAE,CAAC;SAC5C;KACF,CAAC,CAAC;IACH,OAAO,KAAkC,CAAC;;CAC3C;AAED,iBAAkC,KAA4B;IAC5D,IAAI,OAAO,KAAK,KAAK,UAAU,EAAE;QAC/B,KAAK,GAAG,KAAK,CAAC,WAAW,EAAS,CAAC,CAAA;KACpC;IACD,OAAQ,KAAa,CAAC,UAAU,CAAC,CAAC;CACnC;AAED,iBAAkC,KAAU;IAC1C,OAAO,KAAK,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,CAAC,CAAC,OAAO,CAAW,KAA+B,CAAC,CAAC;CACnG;AAED,aAA8B,MAAa,EAAE,KAA4B,EAAE,YAA0C;IAA1C,6BAAA,EAAA,wBAA0C;IACnH,OAAO,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,UAAC,CAAC,EAAE,GAAG,IAAK,OAAA,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,IAAI,YAAY,GAAA,EAAE,MAAa,CAAM,CAAC;CAC3F;AAED,aAA8B,MAAa,EAAE,KAA4B,EAAE,KAAQ;IACjF,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,UAAC,CAAM,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI;QAC7C,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;YAC3B,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,KAAK,OAAO,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,KAAK,QAAQ,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;YACnE,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC;SACf;QACD,CAAC,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;KAChB,EAAE,MAAM,CAAC,CAAC;CACZ;;;;;;;;;;;;;;;;"}